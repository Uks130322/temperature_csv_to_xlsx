import requestsfrom openpyxl import Workbook, load_workbookPATH = "http://www.metoffice.gov.uk/pub/data/weather/uk/climate/stationdata/heathrowdata.txt"TITLE_LEN = 5COLUMN_NAMES_LEN = 2def make_table(path):    """Make a xlsx table with temperatures values download by the path"""    response = requests.get(path)    # print(response.text)    fields = response.text.split("\n")    wb = Workbook()    ws = wb.active    ws.title = "Temperature data"    # make a titles:    for index in range(TITLE_LEN):        ws.append([fields[index]])    # make a columns names:    for index in range(TITLE_LEN, TITLE_LEN + COLUMN_NAMES_LEN):        row = [cell.strip() for cell in fields[index].split(sep="  ") if cell != ""]        if index == TITLE_LEN + COLUMN_NAMES_LEN - 1:            ws.append(["-", "-"] + row)        else:            ws.append(row)    # add the datas:    for index in range(TITLE_LEN + COLUMN_NAMES_LEN, len(fields)):        row = []        for i, cell in enumerate(fields[index].split(sep="  ")):            if cell != "":                cell = cell.strip(" *")                cell = cell.replace("#", "")                try:                    if i > 1:                        cell = float(cell)                    else:                        cell = int(cell)                except ValueError:                    pass                row.append(cell)        ws.append(row)    wb.save("temp_data_03.xlsx")def analyse_temp():    """Find middle maximum and middle minimum temperature of every year, and also middle rainfall of all years.    Create new sheet with this data"""    wb = load_workbook("temp_data_03.xlsx")    ws = wb.active    ws2 = wb.create_sheet("Middle values")    def mid_rain():        """Find middle rainfall"""        title = ["Middle rainfall:"]        ws2.append(title)        rains = []        for cell in ws["F"]:            if cell.value:                try:                    cell = float(cell.value)                    rains.append(cell)                except ValueError:                    pass        middle_rain = sum(rains) / len(rains)        ws2.append([middle_rain])    def mid_temp():        """Find middle maximum and middle minimum temperature of every year"""        title = ["yyyy", "mid tmax", "mid tmin"]        ws2.append(title)        start = TITLE_LEN + COLUMN_NAMES_LEN + 1        temp_max = dict()        temp_min = dict()        for i in range(start, ws.max_row):            temp_max[ws[f"A{i}"].value] = temp_max.setdefault(ws[f"A{i}"].value, []) + [ws[f"C{i}"].value]            temp_min[ws[f"A{i}"].value] = temp_min.setdefault(ws[f"A{i}"].value, []) + [ws[f"D{i}"].value]        for key in temp_max.keys():            row = [key, sum(temp_max[key]) / len(temp_max[key]), sum(temp_min[key]) / len(temp_min[key])]            ws2.append(row)    mid_rain()    mid_temp()    wb.save("temp_data_03.xlsx")make_table(PATH)analyse_temp()